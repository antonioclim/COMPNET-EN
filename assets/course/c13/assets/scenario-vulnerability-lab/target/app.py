from flask import Flask, request
import subprocess

app = Flask(__name__)

@app.get("/")
def index():
    return "vuln-target up\n"

@app.get("/ping")
def ping():
    host = request.args.get("host", "127.0.0.1")

    # INTENTIONALLY VULNERABLE: command injection via shell=True
    cmd = f"ping -c 1 {host}"
    out = subprocess.getoutput(cmd)

    return out + "\n"
