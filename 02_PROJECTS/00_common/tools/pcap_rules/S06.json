{
  "project": "S06",
  "pcap_relpath": "artifacts/pcap/traffic_e2.pcap",
  "decode_as": [],
  "rules": [
    {
      "id": "R1",
      "filter": "tcp.dstport==5006 && tcp.flags.syn==1 && tcp.flags.ack==0",
      "condition": ">= 1",
      "description": "Handshake to the broker."
    },
    {
      "id": "R2",
      "filter": "tcp.port==5006 && (frame contains \"HELLO\" || frame contains \"AUTH\")",
      "condition": ">= 1",
      "description": "Client registration (HELLO/AUTH)."
    },
    {
      "id": "R3",
      "filter": "tcp.port==5006 && (frame contains \"SUBSCRIBE\" || frame contains \"SUB \")",
      "condition": ">= 1",
      "description": "At least one SUBSCRIBE."
    },
    {
      "id": "R4",
      "filter": "tcp.port==5006 && (frame contains \"PUBLISH\" || frame contains \"PUB \")",
      "condition": ">= 1",
      "description": "At least one PUBLISH."
    },
    {
      "id": "R5",
      "filter": "tcp.port==5006 && (frame contains \"DELIVER\" || frame contains \"MSG \")",
      "condition": ">= 1",
      "description": "The broker delivers at least one message to a subscriber (push)."
    }
  ]
}
