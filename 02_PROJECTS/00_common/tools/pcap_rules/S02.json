{
  "project": "S02",
  "pcap_relpath": "artifacts/pcap/traffic_e2.pcap",
  "decode_as": [],
  "rules": [
    {
      "id": "R1",
      "filter": "tcp.dstport==5021 && tcp.flags.syn==1 && tcp.flags.ack==0",
      "condition": ">= 1",
      "description": "Handshake on the control channel."
    },
    {
      "id": "R2",
      "filter": "tcp.port==5021 && frame contains \"USER\"",
      "condition": ">= 1",
      "description": "Authentication on the control channel (USER)."
    },
    {
      "id": "R3",
      "filter": "tcp.port==5021 && (frame contains \"PASV\" || frame contains \"227\")",
      "condition": ">= 1",
      "description": "Passive-mode negotiation (PASV/227)."
    },
    {
      "id": "R4",
      "filter": "tcp.dstport>=60000 && tcp.dstport<=60100 && tcp.flags.syn==1 && tcp.flags.ack==0",
      "condition": ">= 1",
      "description": "Handshake on the data channel (port in the passive range)."
    },
    {
      "id": "R5",
      "filter": "tcp.port>=60000 && tcp.port<=60100 && tcp.len>0",
      "condition": ">= 1",
      "description": "Actual data transfer (payload) on the data channel."
    },
    {
      "id": "R6",
      "filter": "tcp.port==5021 && (frame contains \"SHA-256\" || frame contains \"HASH\")",
      "condition": ">= 1",
      "description": "Checksum reporting (SHAâ€‘256) after the transfer."
    }
  ]
}
