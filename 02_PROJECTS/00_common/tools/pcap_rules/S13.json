{
  "project": "S13",
  "pcap_relpath": "artifacts/pcap/traffic_e2.pcap",
  "decode_as": [],
  "rules": [
    {
      "id": "R1",
      "filter": "tcp.dstport==50051 && tcp.flags.syn==1 && tcp.flags.ack==0",
      "condition": ">= 1",
      "description": "Handshake to the gRPC endpoint (50051)."
    },
    {
      "id": "R2",
      "filter": "tcp.port==50051 && frame contains \"PRI * HTTP/2.0\"",
      "condition": ">= 1",
      "description": "HTTP/2 preface (gRPC without TLS in E2)."
    },
    {
      "id": "R3",
      "filter": "tcp.port==50051 && tcp.len>0",
      "condition": ">= 5",
      "description": "Sufficient HTTP/2 traffic (at least 5 data-bearing segments)."
    },
    {
      "id": "R4",
      "filter": "tcp.dstport==50052 && tcp.flags.syn==1 && tcp.flags.ack==0",
      "condition": ">= 1",
      "description": "Handshake to the raw-protobuf endpoint (50052)."
    },
    {
      "id": "R5",
      "filter": "tcp.port==50052 && frame contains \"PB1\"",
      "condition": ">= 1",
      "description": "Raw protobuf message contains the PB1 magic value (an E1 requirement for determinism)."
    }
  ]
}
