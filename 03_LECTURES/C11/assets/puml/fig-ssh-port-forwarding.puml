@startuml

skinparam backgroundColor white
skinparam shadowing false
skinparam roundcorner 12
skinparam defaultFontName Arial
skinparam defaultFontSize 14

title SSH: port forwarding (local vs remote vs dynamic)

actor User
node "Client machine" as C
node "SSH Server\n(bastion)" as B
node "Internal service\n(db, http, etc)" as I

rectangle "Local forwarding" as L {
  User -> C : connect localhost:9000
  C -> B : SSH tunnel
  B -> I : connect internal:5432
  note right of L
  L: local_port -> remote_target
  Access to internal services via bastion
  end note
}

rectangle "Remote forwarding" as R {
  User -> B : connect server:9000
  B -> C : SSH tunnel
  C -> I : connect local/internal
  note right of R
  R: remote_port -> client_target
  Expose a client service through the server
  end note
}

rectangle "Dynamic (SOCKS)" as D {
  User -> C : browser -> localhost:1080
  C -> B : SSH tunnel (SOCKS)
  B -> I : dynamic connections
  note right of D
  General-purpose proxy via SSH
  end note
}

@enduml
