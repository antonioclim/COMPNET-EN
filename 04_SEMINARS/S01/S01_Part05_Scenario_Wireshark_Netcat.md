### Introduction

This stage uses **Wireshark** to capture and analyse the traffic generated by `netcat` connections. The goal is to understand what TCP and UDP traffic looks like at packet level and how to apply the two types of Wireshark filters:

* **PCAP (capture) filters** – applied *before* capture and limit which packets are recorded.
* **Visualisation (display) filters** – applied *after* capture and help filter the packets that are shown.

---

### Capturing traffic for a TCP netcat server

#### 1. Start Wireshark and select the network interface

Choose the interface through which the traffic will pass (e.g., `eth0`, `wlan0`).

#### 2. Configure a **capture filter** to capture only TCP traffic to port 9200

In the *Capture Filter* field, enter:

```
tcp port 9200
```

Then start the capture.

#### 3. Start the TCP netcat server on port 9200

```
nc -l -p 9200
```

#### 4. Connect the client to the server

```
nc 127.0.0.1 9200
```

Send a few messages and observe the packets in Wireshark.

---

### Analysing traffic in Wireshark

Observe:

* the TCP sequence (SYN → SYN-ACK → ACK),
* packets that contain payload,
* possible retransmissions if you interrupt the connection.

After capture, apply a **display filter**:

```
tcp.stream eq 0
```

This isolates the specific TCP conversation.

---

### Capturing traffic for UDP netcat

#### 1. Configure a **capture filter** for UDP port 9201

```
udp port 9201
```

Starting the capture will record only relevant UDP packets.

#### 2. UDP netcat server

```
nc -u -l -p 9201
```

#### 3. Sending a UDP message

```
echo "UDP test" | nc -u 127.0.0.1 9201
```

Observe in Wireshark that:

* there is no handshake,
* there are no TCP streams,
* each message is an independent packet.

After capture, apply a display filter:

```
udp.port == 9201
```

---

### Notes

Note that:

* **Capture filters** are Wireshark restrictions at libpcap level. They cannot be changed after the capture starts.
* **Display filters** can be changed at any time and enable in-depth exploration of captured conversations.
* TCP traffic has state (handshake, acknowledgements and seq/ack numbers).
* UDP traffic appears as individual packets, without connection establishment.
