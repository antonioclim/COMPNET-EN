### Scenario: UDP server and client in Python, testing with netcat and analysing in Wireshark

#### 1. Objective

In this stage you will:

- run a UDP server in Python;
- test the server with netcat;
- run a Python UDP client (example + template);
- observe in Wireshark how UDP traffic looks (no handshake and no connection);
- compare the behaviour with TCP from the previous stage.

---

### 2. Running the example UDP server

Start the reference UDP server:

```bash
python3 S02_Part07_Example_UDP_Server.py 12345
```

You should see:

```text
[INFO] UDP server listening on 0.0.0.0:12345
```

Leave the server running.

---

### 3. Testing the UDP server with netcat

In another terminal, use `netcat` in UDP mode:

```bash
echo "hello udp" | nc -u 127.0.0.1 12345
```

Observe:

* in the server terminal: a log line with the received message and the client address;
* in the `nc` terminal: you might not see a reply (depends on the version and parameters).
  To see replies reliably, use the Python client below.

---

### 4. Testing the UDP server with the example Python client

Run the simple client:

```bash
python3 S02_Part09_Example_UDP_Client.py 127.0.0.1 12345 "Hello from client"
```

You should see in the client:

```text
[INFO] Sending ... bytes to 127.0.0.1:12345 ...
[INFO] Received ... bytes from ('127.0.0.1', 12345): b'HELLO FROM CLIENT'
```

And in the server, corresponding logs.

---

### 5. Capturing UDP traffic in Wireshark

1. Open **Wireshark** and select the relevant interface (`lo`, `eth0`, `wlan0`, etc.).

2. Configure a **capture filter** for the UDP port used:

```text
udp port 12345
```

3. Start capture.

4. While capture is running, run commands such as:

```bash
echo "test1" | nc -u 127.0.0.1 12345
python3 S02_Part09_Example_UDP_Client.py 127.0.0.1 12345 "ping"
```

5. Stop capture and apply a **display filter**:

```text
udp.port == 12345
```

Observe:

* each datagram sent by the client,
* the server reply,
* the fact that there is no handshake (no SYN/SYN-ACK/ACK as in TCP),
* packets appear as request–response pairs, but without the notion of a TCP stream.

---

### 6. Student task – completing the UDP server (template)

1. Open `S02_Part08_Template_UDP_Server.py`.

2. Implement the logic described in the `TODO` block:

   * decode the message,
   * detailed log with IP, port, text and number of bytes,
   * implement the protocol:

     * `ping` → `PONG`
     * `upper:...` → the part after `upper:` in uppercase
     * anything else → `UNKNOWN COMMAND`

3. Run the template server:

```bash
python3 S02_Part08_Template_UDP_Server.py 12345
```

4. Test it:

   * using `netcat`:

     ```bash
     echo "ping" | nc -u 127.0.0.1 12345
     echo "upper:hello world" | nc -u 127.0.0.1 12345
     ```

   * using the example client:

     ```bash
     python3 S02_Part09_Example_UDP_Client.py 127.0.0.1 12345 ping
     python3 S02_Part09_Example_UDP_Client.py 127.0.0.1 12345 "upper:hello"
     ```

Observe responses and logs.

---

### 7. Student task – completing the interactive UDP client (template)

1. Open `S02_Part10_Template_UDP_Client.py`.

2. Complete the `TODO` section according to the requirements:

   * interactive loop until `exit`,
   * send a message to the server,
   * timeout for the reply,
   * approximate RTT calculation for messages that receive a reply,
   * final statistics (sent/received/loss).

3. Run the client:

```bash
python3 S02_Part10_Template_UDP_Client.py 127.0.0.1 12345
```

Send at least 5 messages:

* two `ping`,
* two `upper:...`,
* one random text (e.g., `abc`).

---

### 8. Wireshark capture for UDP Python–Python communication

1. Start a new capture with a **capture filter**:

```text
udp port 12345
```

2. While capture is running:

   * run the template server,
   * run the template client and send the 5 test messages.

3. Stop capture and apply:

```text
udp.port == 12345
```

4. For at least two messages:

   * identify the client datagram (request),
   * identify the server datagram (response),
   * compare Wireshark timing with the RTT displayed by the client.

---

### 9. Work evidence (what you will upload)

1. `udp_server_activity_output.txt`:

   * the commands used to run the example and template server,
   * at least 5 server log lines (for different commands: `ping`, `upper:...` and others),
   * a short comment (3–5 sentences) about the behaviour of the protocol (`PONG`, `UNKNOWN COMMAND` and similar cases).

2. `udp_client_activity_output.txt`:

   * interactive client logs (sent messages, received replies, RTT and timeouts),
   * final statistics (sent/received).

3. `udp_traffic_capture.pcapng`:

   * Wireshark capture with the UDP traffic generated by your tests.

These files will demonstrate that you understand:

* how UDP works at code level,
* how UDP traffic looks in Wireshark,
* the differences compared with TCP (no handshake and no persistent connection).
