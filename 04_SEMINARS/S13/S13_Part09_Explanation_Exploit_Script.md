#### Seminar 13 – Stage 5

## Building a Python Exploit for vsftpd 2.3.4

The final stage implements a complete exploit for the vulnerability:

**CVE-2011-2523 — vsftpd 2.3.4 smiley backdoor**

The goal is for students to understand what a minimal exploit looks like, featuring:

* automated connections
* triggering the vulnerability
* connecting to the backdoor
* executing a command in the shell

In the original version, the backdoor provided a root shell.
In our lab, we obtain a restricted shell (safe for execution).

---

## 1. Exploit Flow

1. **Connect to vsftpd (port 2121)**
2. Send:

   ```
   USER test:)
   PASS whatever
   ```

   → Activates the backdoor.
3. **Connect to port 6200**
4. Send a command (`id`, `whoami`)
5. Display the output

---

## 2. Techniques Used

* `socket.socket()` for connections
* `.recv()` for reading the banner
* `.sendall()` for sending commands
* small delays (0.1 s) for synchronisation
* error handling (port 6200 may not be available if Stage 1 was not completed correctly)

---

## 3. Why This Stage Is Useful

Students see in practice:

* what a real (albeit simplified) exploit looks like
* how logical vulnerabilities combine with network implementations
* how manual attacks are automated
* how trivial an exploit can be when a service is vulnerable
